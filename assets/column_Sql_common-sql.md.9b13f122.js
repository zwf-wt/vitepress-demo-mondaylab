import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.05cb957e.js";const b=JSON.parse('{"title":"常用SQL语句","description":"","frontmatter":{},"headers":[],"relativePath":"column/Sql/common-sql.md","filePath":"column/Sql/common-sql.md"}'),p={name:"column/Sql/common-sql.md"},e=l(`<h1 id="常用sql语句" tabindex="-1">常用SQL语句 <a class="header-anchor" href="#常用sql语句" aria-label="Permalink to &quot;常用SQL语句&quot;">​</a></h1><h2 id="_1-增" tabindex="-1">1. 增 <a class="header-anchor" href="#_1-增" aria-label="Permalink to &quot;1. 增&quot;">​</a></h2><h3 id="_1-1-创建表" tabindex="-1">1.1 创建表 <a class="header-anchor" href="#_1-1-创建表" aria-label="Permalink to &quot;1.1 创建表&quot;">​</a></h3><h4 id="_1-1-1-使用select快速建表" tabindex="-1">1.1.1 使用select快速建表 <a class="header-anchor" href="#_1-1-1-使用select快速建表" aria-label="Permalink to &quot;1.1.1 使用select快速建表&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">  Column1,</span></span>
<span class="line"><span style="color:#E1E4E8;">  Column2,</span></span>
<span class="line"><span style="color:#E1E4E8;">  Column3</span></span>
<span class="line"><span style="color:#F97583;">INTO</span><span style="color:#E1E4E8;"> NewTable</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> OldTable;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 使用SELECT INTO语句创建的新表将不包含任何索引、约束和其他对象。</span></span>
<span class="line"><span style="color:#6A737D;">-- 如果需要添加索引、约束或其他结构，请在创建新表之后，按需使用ALTER TABLE语句进行修改。</span></span>
<span class="line"><span style="color:#6A737D;">-- 在使用SELECT INTO创建新表时，确保新表不存在，以避免意外替换或覆盖现有表。</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">  Column1,</span></span>
<span class="line"><span style="color:#24292E;">  Column2,</span></span>
<span class="line"><span style="color:#24292E;">  Column3</span></span>
<span class="line"><span style="color:#D73A49;">INTO</span><span style="color:#24292E;"> NewTable</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> OldTable;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 使用SELECT INTO语句创建的新表将不包含任何索引、约束和其他对象。</span></span>
<span class="line"><span style="color:#6A737D;">-- 如果需要添加索引、约束或其他结构，请在创建新表之后，按需使用ALTER TABLE语句进行修改。</span></span>
<span class="line"><span style="color:#6A737D;">-- 在使用SELECT INTO创建新表时，确保新表不存在，以避免意外替换或覆盖现有表。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_2-删" tabindex="-1">2. 删 <a class="header-anchor" href="#_2-删" aria-label="Permalink to &quot;2. 删&quot;">​</a></h2><h3 id="_2-1-删除表的中数据" tabindex="-1">2.1 删除表的中数据 <a class="header-anchor" href="#_2-1-删除表的中数据" aria-label="Permalink to &quot;2.1 删除表的中数据&quot;">​</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- 方式1: 使用 TRUNCATE</span></span>
<span class="line"><span style="color:#F97583;">TRUNCATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> table_name;</span></span>
<span class="line"><span style="color:#6A737D;">-- 方式2：使用 DELETE</span></span>
<span class="line"><span style="color:#F97583;">DELETE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> table_name</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> condition;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- 方式1: 使用 TRUNCATE</span></span>
<span class="line"><span style="color:#D73A49;">TRUNCATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> table_name;</span></span>
<span class="line"><span style="color:#6A737D;">-- 方式2：使用 DELETE</span></span>
<span class="line"><span style="color:#D73A49;">DELETE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> table_name</span></span>
<span class="line"><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> condition;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_3-改" tabindex="-1">3. 改 <a class="header-anchor" href="#_3-改" aria-label="Permalink to &quot;3. 改&quot;">​</a></h2><h3 id="_3-1-更新数据" tabindex="-1">3.1 更新数据 <a class="header-anchor" href="#_3-1-更新数据" aria-label="Permalink to &quot;3.1 更新数据&quot;">​</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> users</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> age </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;">, email </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;john@example.com&#39;</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;John&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">UPDATE</span><span style="color:#24292E;"> users</span></span>
<span class="line"><span style="color:#D73A49;">SET</span><span style="color:#24292E;"> age </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">, email </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;john@example.com&#39;</span></span>
<span class="line"><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">name</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;John&#39;</span><span style="color:#24292E;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-2-update使用case-when语句" tabindex="-1">3.2 UPDATE使用CASE...WHEN语句 <a class="header-anchor" href="#_3-2-update使用case-when语句" aria-label="Permalink to &quot;3.2 UPDATE使用CASE...WHEN语句&quot;">​</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- 将男改成女，将女改成男</span></span>
<span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> Salary</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> sex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">CASE</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> sex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;m&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;f&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> sex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;f&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;m&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">END</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- 将男改成女，将女改成男</span></span>
<span class="line"><span style="color:#D73A49;">UPDATE</span><span style="color:#24292E;"> Salary</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">SET</span><span style="color:#24292E;"> sex </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">CASE</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> sex </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;m&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;f&#39;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> sex </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;f&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;m&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">END</span><span style="color:#24292E;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_4-查" tabindex="-1">4. 查 <a class="header-anchor" href="#_4-查" aria-label="Permalink to &quot;4. 查&quot;">​</a></h2><h3 id="_4-1-join相关" tabindex="-1">4.1 JOIN相关 <a class="header-anchor" href="#_4-1-join相关" aria-label="Permalink to &quot;4.1 JOIN相关&quot;">​</a></h3><h4 id="_4-1-1-join案例" tabindex="-1">4.1.1 JOIN案例 <a class="header-anchor" href="#_4-1-1-join案例" aria-label="Permalink to &quot;4.1.1 JOIN案例&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Customers</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">CustomerID</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Customers</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">CustomerName</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Orders</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">OrderID</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Orders</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">OrderDate</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> Customers</span></span>
<span class="line"><span style="color:#F97583;">LEFT JOIN</span><span style="color:#E1E4E8;"> Orders </span><span style="color:#F97583;">ON</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Customers</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">CustomerID</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Orders</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">CustomerID</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Customers</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">CustomerID</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Customers</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">CustomerName</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Orders</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">OrderID</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Orders</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">OrderDate</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> Customers</span></span>
<span class="line"><span style="color:#D73A49;">LEFT JOIN</span><span style="color:#24292E;"> Orders </span><span style="color:#D73A49;">ON</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Customers</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">CustomerID</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Orders</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">CustomerID</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-2-对数据进行去重操作" tabindex="-1">4.2 对数据进行去重操作 <a class="header-anchor" href="#_4-2-对数据进行去重操作" aria-label="Permalink to &quot;4.2 对数据进行去重操作&quot;">​</a></h3><h4 id="_4-2-1-使用group-by-having" tabindex="-1">4.2.1 使用group by...having <a class="header-anchor" href="#_4-2-1-使用group-by-having" aria-label="Permalink to &quot;4.2.1 使用group by...having&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- sql server</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">  supplier_code</span></span>
<span class="line"><span style="color:#E1E4E8;">  , supplier</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> [ODS].[ods_inv_d_d08_supplier_mapping]</span></span>
<span class="line"><span style="color:#F97583;">GROUP BY</span></span>
<span class="line"><span style="color:#E1E4E8;">  supplier_code</span></span>
<span class="line"><span style="color:#E1E4E8;">  , supplier</span></span>
<span class="line"><span style="color:#F97583;">HAVING</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">COUNT</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- sql server</span></span>
<span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">  supplier_code</span></span>
<span class="line"><span style="color:#24292E;">  , supplier</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> [ODS].[ods_inv_d_d08_supplier_mapping]</span></span>
<span class="line"><span style="color:#D73A49;">GROUP BY</span></span>
<span class="line"><span style="color:#24292E;">  supplier_code</span></span>
<span class="line"><span style="color:#24292E;">  , supplier</span></span>
<span class="line"><span style="color:#D73A49;">HAVING</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">COUNT</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_4-3-逆透视" tabindex="-1">4.3 逆透视 <a class="header-anchor" href="#_4-3-逆透视" aria-label="Permalink to &quot;4.3 逆透视&quot;">​</a></h3><table><thead><tr><th>ProductName</th><th>JanuarySales</th><th>FebruarySales</th><th>MarchSales</th></tr></thead><tbody><tr><td>ProductA</td><td>1000</td><td>1500</td><td>1200</td></tr><tr><td>Product B</td><td>800</td><td>900</td><td>700</td></tr><tr><td>Product C</td><td>1200</td><td>1000</td><td>800</td></tr></tbody></table><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> ProductName, SalesMonth, SalesAmount</span></span>
<span class="line"><span style="color:#F97583;">FROM</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> ProductName, JanuarySales, FebruarySales, MarchSales</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> Sales</span></span>
<span class="line"><span style="color:#E1E4E8;">) p</span></span>
<span class="line"><span style="color:#E1E4E8;">UNPIVOT</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  SalesAmount </span><span style="color:#F97583;">FOR</span><span style="color:#E1E4E8;"> SalesMonth </span><span style="color:#F97583;">IN</span><span style="color:#E1E4E8;"> (JanuarySales, FebruarySales, MarchSales)</span></span>
<span class="line"><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> UnpivotedData;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> ProductName, SalesMonth, SalesAmount</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span></span>
<span class="line"><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> ProductName, JanuarySales, FebruarySales, MarchSales</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> Sales</span></span>
<span class="line"><span style="color:#24292E;">) p</span></span>
<span class="line"><span style="color:#24292E;">UNPIVOT</span></span>
<span class="line"><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  SalesAmount </span><span style="color:#D73A49;">FOR</span><span style="color:#24292E;"> SalesMonth </span><span style="color:#D73A49;">IN</span><span style="color:#24292E;"> (JanuarySales, FebruarySales, MarchSales)</span></span>
<span class="line"><span style="color:#24292E;">) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> UnpivotedData;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><table><thead><tr><th>ProductName</th><th>SalesMonth</th><th>SalesAmount</th></tr></thead><tbody><tr><td>Product A</td><td>JanuarySales</td><td>1000</td></tr><tr><td>Product A</td><td>FebruarySales</td><td>1500</td></tr><tr><td>Product A</td><td>MarchSales</td><td>1200</td></tr><tr><td>Product B</td><td>JanuarySales</td><td>800</td></tr><tr><td>Product B</td><td>FebruarySales</td><td>900</td></tr><tr><td>Product B</td><td>MarchSales</td><td>700</td></tr><tr><td>Product C</td><td>JanuarySales</td><td>1200</td></tr><tr><td>Product C</td><td>FebruarySales</td><td>1000</td></tr><tr><td>Product C</td><td>MarchSales</td><td>800</td></tr></tbody></table><h3 id="_4-4-各种函数操作" tabindex="-1">4.4 各种函数操作 <a class="header-anchor" href="#_4-4-各种函数操作" aria-label="Permalink to &quot;4.4 各种函数操作&quot;">​</a></h3><h4 id="_1-日期型" tabindex="-1">1. 日期型 <a class="header-anchor" href="#_1-日期型" aria-label="Permalink to &quot;1. 日期型&quot;">​</a></h4><ul><li><ol><li>将字符串转换成日期</li></ol></li></ul><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">CONVERT</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">CAST</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;2022-10&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;-01&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DATE</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">23</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#6A737D;">-- 2022-10-01</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">CONVERT</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">VARCHAR</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">CAST</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;2022-10&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;-01&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DATE</span><span style="color:#24292E;">), </span><span style="color:#005CC5;">23</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;">-- 2022-10-01</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-数字型" tabindex="-1">2. 数字型 <a class="header-anchor" href="#_2-数字型" aria-label="Permalink to &quot;2. 数字型&quot;">​</a></h4><ul><li><ol><li>将varchar &#39;92284.27&#39;转换成float</li></ol></li></ul><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- CONVERT</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">CONVERT</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">FLOAT</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;92284.27&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">  , </span><span style="color:#79B8FF;">CAST</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;92284.27&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FLOAT</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- CONVERT</span></span>
<span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">CONVERT</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">FLOAT</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;92284.27&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  , </span><span style="color:#005CC5;">CAST</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;92284.27&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FLOAT</span><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_3-字符串" tabindex="-1">3. 字符串 <a class="header-anchor" href="#_3-字符串" aria-label="Permalink to &quot;3. 字符串&quot;">​</a></h4><ul><li><ol><li>REPLACE</li></ol></li></ul><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;abc_def_efg&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">REPLACE</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;abc_def_efg&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;_&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;**&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#6A737D;">--  abc_def_efg, abc**def**efg</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;abc_def_efg&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">REPLACE</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;abc_def_efg&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;_&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;**&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;">--  abc_def_efg, abc**def**efg</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_4-case-when" tabindex="-1">4. case...when <a class="header-anchor" href="#_4-case-when" aria-label="Permalink to &quot;4. case...when&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  score,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">CASE</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">90</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;A&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;B&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">70</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;C&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">WHEN</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">THEN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;D&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">ELSE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;E&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">END</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> grade</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> student;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">name</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  score,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">CASE</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">90</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;A&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">80</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;B&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">70</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;C&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">WHEN</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">THEN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;D&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">ELSE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;E&#39;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">END</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> grade</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> student;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-其他" tabindex="-1">5. 其他 <a class="header-anchor" href="#_5-其他" aria-label="Permalink to &quot;5. 其他&quot;">​</a></h2><h3 id="_5-1-sql-书写顺序" tabindex="-1">5.1 sql 书写顺序 <a class="header-anchor" href="#_5-1-sql-书写顺序" aria-label="Permalink to &quot;5.1 sql 书写顺序&quot;">​</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> column1, column2, aggregate_function(column3)</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> table1</span></span>
<span class="line"><span style="color:#F97583;">LEFT JOIN</span><span style="color:#E1E4E8;"> table2 </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">table1</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">column</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">table2</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">column</span></span>
<span class="line"><span style="color:#6A737D;">-- 筛选条件</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> condition1</span></span>
<span class="line"><span style="color:#6A737D;">-- 分组</span></span>
<span class="line"><span style="color:#F97583;">GROUP BY</span><span style="color:#E1E4E8;"> column1, column2</span></span>
<span class="line"><span style="color:#F97583;">HAVING</span><span style="color:#E1E4E8;"> condition2</span></span>
<span class="line"><span style="color:#6A737D;">-- 排序</span></span>
<span class="line"><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> column1 </span><span style="color:#F97583;">ASC</span><span style="color:#E1E4E8;">, column2 </span><span style="color:#F97583;">DESC</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- sql 子句的执行顺序</span></span>
<span class="line"><span style="color:#6A737D;">-- 1. FROM：指定从中检索数据的表</span></span>
<span class="line"><span style="color:#6A737D;">-- 2. WHERE：根据指定的条件筛选行</span></span>
<span class="line"><span style="color:#6A737D;">-- 3. Group BY：根据指定的列或表达式对行进行分组</span></span>
<span class="line"><span style="color:#6A737D;">-- 4. HAVING：根据条件筛选分组的行</span></span>
<span class="line"><span style="color:#6A737D;">-- 5. SELECT: 选择将在结果集中返回的列或表达式</span></span>
<span class="line"><span style="color:#6A737D;">-- 6. DISTINCT: 去重</span></span>
<span class="line"><span style="color:#6A737D;">-- 7. ORDER BY: 根据指定的列表达式对结果集进行排序</span></span>
<span class="line"><span style="color:#6A737D;">-- 8. LIMIT: 限制结果集中返回的行数</span></span>
<span class="line"><span style="color:#6A737D;">-- 注意：DBMS可能会以等价但不同的顺序执行一个查询</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> column1, column2, aggregate_function(column3)</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> table1</span></span>
<span class="line"><span style="color:#D73A49;">LEFT JOIN</span><span style="color:#24292E;"> table2 </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">table1</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">column</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">table2</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">column</span></span>
<span class="line"><span style="color:#6A737D;">-- 筛选条件</span></span>
<span class="line"><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> condition1</span></span>
<span class="line"><span style="color:#6A737D;">-- 分组</span></span>
<span class="line"><span style="color:#D73A49;">GROUP BY</span><span style="color:#24292E;"> column1, column2</span></span>
<span class="line"><span style="color:#D73A49;">HAVING</span><span style="color:#24292E;"> condition2</span></span>
<span class="line"><span style="color:#6A737D;">-- 排序</span></span>
<span class="line"><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> column1 </span><span style="color:#D73A49;">ASC</span><span style="color:#24292E;">, column2 </span><span style="color:#D73A49;">DESC</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- sql 子句的执行顺序</span></span>
<span class="line"><span style="color:#6A737D;">-- 1. FROM：指定从中检索数据的表</span></span>
<span class="line"><span style="color:#6A737D;">-- 2. WHERE：根据指定的条件筛选行</span></span>
<span class="line"><span style="color:#6A737D;">-- 3. Group BY：根据指定的列或表达式对行进行分组</span></span>
<span class="line"><span style="color:#6A737D;">-- 4. HAVING：根据条件筛选分组的行</span></span>
<span class="line"><span style="color:#6A737D;">-- 5. SELECT: 选择将在结果集中返回的列或表达式</span></span>
<span class="line"><span style="color:#6A737D;">-- 6. DISTINCT: 去重</span></span>
<span class="line"><span style="color:#6A737D;">-- 7. ORDER BY: 根据指定的列表达式对结果集进行排序</span></span>
<span class="line"><span style="color:#6A737D;">-- 8. LIMIT: 限制结果集中返回的行数</span></span>
<span class="line"><span style="color:#6A737D;">-- 注意：DBMS可能会以等价但不同的顺序执行一个查询</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div>`,39),o=[e];function r(c,t,E,y,i,d){return a(),n("div",null,o)}const h=s(p,[["render",r]]);export{b as __pageData,h as default};
